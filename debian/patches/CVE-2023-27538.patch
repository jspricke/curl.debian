From: Markus Koschany <apo@debian.org>
Date: Tue, 18 Apr 2023 15:17:19 +0200
Subject: CVE-2023-27538

Origin: https://github.com/curl/curl/commit/af369db4d3833272b8ed443f7fcc2e757a0872eb
---
 lib/url.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/lib/url.c b/lib/url.c
index 4e070f1..565a1ff 100644
--- a/lib/url.c
+++ b/lib/url.c
@@ -1316,8 +1316,8 @@ ConnectionExists(struct Curl_easy *data,
       if(needle->gssapi_delegation != check->gssapi_delegation)
         continue;
 
-      if(get_protocol_family(needle->handler->protocol) == CURLPROTO_SCP ||
-              get_protocol_family(needle->handler->protocol) == CURLPROTO_SFTP) {
+      if(get_protocol_family(needle->handler->protocol) & CURLPROTO_SCP ||
+              get_protocol_family(needle->handler->protocol) & CURLPROTO_SFTP) {
 
         if(!ssh_config_matches(needle, check))
           continue;
